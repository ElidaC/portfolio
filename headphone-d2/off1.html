<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://use.typekit.net/sty5dnx.css">
    <link rel="stylesheet" href="style.css">
    <title>Listening in Between</title>

    <style>
      body {
  position: relative;
  overflow-x: hidden;
}

body::before {
  content: "";
  position: fixed;
  inset: 0;
  background-image: url("bg/1-1.png");
  background-size: 105% auto;
  background-position: top center;
  filter: blur(20px); 
  opacity: 0.3;  
  transform: scale(1.1); 
  z-index: -1;
}

.navigation{
  background-color: #172d85;
}

p{
  color: #172d85;
}

body { transition: filter 0.4s ease; backdrop-filter: blur(0px); }
      </style>
</head>
<body>

    <div class="h-axis" role="slider" aria-label="Power"
         aria-valuemin="0" aria-valuemax="1" aria-valuenow="0"
         tabindex="0">
      <span class="h-label">ON</span>
      <div class="h-track">
        <div class="h-thumb" data-position="off"></div>
      </div>
      <span class="h-label">OFF</span>
    </div>
  </main>
  
<a href="index.html">
  <div class="navigation"></div>
</a>

  <div class="lang-switch">
    <button class="lang-btn active" data-lang="chinese">中文</button>
    <button class="lang-btn" data-lang="english">English</button>
  </div>

  <div class="intro">
    <p>Tara W. - F - 5yrs</p>
    <p>Airpods Pro </p>
    <p>Volumn: 5/10</p>
    <p>When feeling down at midnight</p>
  </div>

    <div class="text" id="chinese" data-native="true">
        <p style="position: absolute; top:30%; left: 40%;">耳机对我来说像一扇门。</p>
        <p style="position: absolute; top:35%; left: 20%;">那里没有人叫我的名字，也没有人需要我微笑，</p>
        <p style="position: absolute; top:40%; left: 30%;">但是有一股力量让我在这个世界里越陷越深。</p>
        <p style="position: absolute; top:45%; left: 25%;">我在那儿失重、碎裂、再一点点重组自己的另一副模样。</p>
        <p style="position: absolute; top:50%; left: 15%;">没有人认识这个世界里的我，我也不认识，</p>
        <p style="position: absolute; top:55%; left: 35%;">但是他可以带走我所有的坏情绪，让我安静得躺在这个空间里充电，</p>
        <p style="position: absolute; top:60%; left: 50%;">看自己成长，迎接新的一天。</p>
    </div>

    <div class="text" id="english">
        <p style="position: absolute; top:30%; left: 40%;">Headphones are like a doorway for me.</p>
        <p style="position: absolute; top:35%; left: 20%;">Once I step in, no one calls my name and no one expects me to smile.</p>
        <p style="position: absolute; top:40%; left: 30%;">It's just a space that pulls me in, </p>
        <p style="position: absolute; top:45%; left: 25%;">a place where I can float, fall apart,</p>
        <p style="position: absolute; top:50%; left: 15%;">and slowly piece myself back together into someone new.</p>
        <p style="position: absolute; top:55%; left: 35%;">No one knows who I am there, me either.</p>
        <p style="position: absolute; top:60%; left: 50%;">But that world absorbs all my bad feelings,</p>
        <p style="position: absolute; top:65%; left: 45%;">lets me go quiet, recharge,</p>
        <p style="position: absolute; top:70%; left: 30%;">watch myself grow, and come back ready for a new day.</p>
    </div>

    <div class="font-control">
        <button class="control-btn plus"></button>
        <button class="control-btn minus"></button>
      </div>
    







    <script src="script.js"></script>
    <script>
(() => {
  // 小工具函数
  const clamp = (n, min, max) => Math.min(Math.max(n, min), max);
  const $ = (selector, root = document) => root.querySelector(selector);

  const hAxis  = $(".h-axis");
  const hTrack = $(".h-track");
  const hThumb = $(".h-thumb");

  // 没有找到元素就直接退出
  if (!hAxis || !hTrack || !hThumb) return;

  // —— 识别当前是不是 on/off 页面（可按需要改文件名） —— //
  const path = (location.pathname || "").toLowerCase();
  const isOnPage  = /(^|\/)on1\.html$/.test(path);
  const isOffPage = /(^|\/)off1\.html$/.test(path);

  // 像素 → 百分比
  const pxToPercent = (clientX) => {
    const rect = hTrack.getBoundingClientRect();
    const x = clamp(clientX - rect.left, 0, rect.width);
    return (x / rect.width) * 100;
  };

  // 设置滑块位置（0–100）
  function setPos(percent, { updateAria = false } = {}) {
    percent = clamp(percent, 0, 100);
    // 这里用 CSS 变量 --x 控制位置，记得在 CSS 里用 transform/left 读取它
    hThumb.style.setProperty("--x", percent);

    if (updateAria) {
      // ON = 0, OFF = 1
      const ariaNow = percent <= 50 ? 0 : 1;
      hAxis.setAttribute("aria-valuenow", String(ariaNow));
    }
  }

  // 吸附逻辑：0 或 100
  function snap(percent) {
    return percent <= 50 ? 0 : 100;
  }

  // 吸附后跳转页面
  function navigateByPercent(percent) {
    const side = percent === 0 ? "on" : "off";
    if (side === "on") {
      window.location.href = "on1.html";   // ← 需要的话这里改文件名
    } else {
      window.location.href = "off1.html";  // ← 同上
    }
  }

  // —— 初始化位置 —— //
  if (isOnPage) {
    setPos(0,   { updateAria: true });
  } else if (isOffPage) {
    setPos(100, { updateAria: true });
  } else {
    const init = (hThumb.dataset.position || "off").toLowerCase() === "on" ? 0 : 100;
    setPos(init, { updateAria: true });
  }

  // —— 拖拽逻辑 —— //
  let dragging  = false;
  let pointerId = null;

  const onMove = (e) => {
    if (!dragging) return;
    const clientX = (e.touches && e.touches[0]?.clientX) ?? e.clientX;
    setPos(pxToPercent(clientX), { updateAria: true });
  };

  const onUp = (e) => {
    if (!dragging) return;
    dragging = false;

    if (pointerId != null && hThumb.hasPointerCapture?.(pointerId)) {
      hThumb.releasePointerCapture(pointerId);
    }

    const clientX = (e.changedTouches && e.changedTouches[0]?.clientX) ?? e.clientX;
    const snapped = snap(pxToPercent(clientX));
    setPos(snapped, { updateAria: true });
    navigateByPercent(snapped);

    pointerId = null;

    // 移除全局事件监听
    window.removeEventListener("pointermove", onMove);
    window.removeEventListener("pointerup", onUp);
    window.removeEventListener("touchmove", onMove);
    window.removeEventListener("touchend", onUp);
  };

  // 鼠标 / 触控板拖拽
  hThumb.addEventListener("pointerdown", (e) => {
    e.preventDefault();
    dragging  = true;
    pointerId = e.pointerId;

    hThumb.setPointerCapture?.(pointerId);
    window.addEventListener("pointermove", onMove);
    window.addEventListener("pointerup", onUp);
  });

  // 触屏拖拽
  hThumb.addEventListener("touchstart", (e) => {
    dragging = true;
    window.addEventListener("touchmove", onMove, { passive: false });
    window.addEventListener("touchend", onUp);
  }, { passive: true });

  // —— 点击轨道：直接吸附并跳转 —— //
  hTrack.addEventListener("pointerdown", (e) => {
    if (e.target === hThumb) return; // 如果点的是拇指，就让拇指自己的逻辑处理
    const p       = pxToPercent(e.clientX);
    const snapped = snap(p);
    setPos(snapped, { updateAria: true });
    navigateByPercent(snapped);
  });

  // —— 点击 ON/OFF 文本 —— //
  document.querySelectorAll(".h-label").forEach((lbl) => {
    lbl.addEventListener("click", () => {
      const text = (lbl.textContent || "").trim().toLowerCase();
      if (text === "on") {
        setPos(0,   { updateAria: true });
        navigateByPercent(0);
      }
      if (text === "off") {
        setPos(100, { updateAria: true });
        navigateByPercent(100);
      }
    });
  });

  // —— 键盘支持：在 .h-axis 上 —— //
  hAxis.addEventListener("keydown", (e) => {
    const k    = e.key;
    const curr = parseFloat(getComputedStyle(hThumb).getPropertyValue("--x")) || 0;

    if (k === "ArrowLeft") {
      e.preventDefault();
      setPos(curr - 5, { updateAria: true });
    }
    if (k === "ArrowRight") {
      e.preventDefault();
      setPos(curr + 5, { updateAria: true });
    }
    if (k === "Home") {
      e.preventDefault();
      setPos(0, { updateAria: true });
    }
    if (k === "End") {
      e.preventDefault();
      setPos(100, { updateAria: true });
    }

    if (k === "Enter" || k === " ") {
      e.preventDefault();
      const snapped = snap(curr);
      setPos(snapped, { updateAria: true });
      navigateByPercent(snapped);
    }
  });
})();


    </script>
</body>
</html>